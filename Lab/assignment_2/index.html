<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Form & Table</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />
  </head>
  <body
    class="d-flex justify-content-center align-items-center flex-column mx-auto py-4"
  >
    <form class="row g-3 w-50 mt-3 p-3 rounded bg-light">
      <h1>Bootstrap Form</h1>
      <div class="col-md-6">
        <label for="inputFirstname" class="form-label">First Name</label>
        <input
          type="text"
          name="firstName"
          class="form-control"
          id="inputFirstname"
          placeholder="Elon"
          required
        />
      </div>
      <div class="col-md-6">
        <label for="inputLastname" class="form-label">Last Name</label>
        <input
          type="text"
          name="lastName"
          class="form-control"
          id="inputLastname"
          placeholder="Musk"
          required
        />
      </div>
      <div class="col-md-6">
        <label for="inputEmail4" class="form-label">Email</label>
        <input
          type="email"
          name="email"
          class="form-control"
          id="inputEmail4"
          placeholder="abc@gmail.com"
          required
        />
      </div>
      <div class="col-md-6">
        <label for="inputPassword4" class="form-label">Password</label>
        <input
          name="password"
          type="password"
          class="form-control"
          id="inputPassword4"
          placeholder="Password"
          required
        />
      </div>

      <fieldset class="row mb-3 mt-4">
        <legend class="col-form-label pt-0 d-block">Gender</legend>
        <div class="col-sm-6 d-flex gap-3">
          <div class="form-check col-md-3">
            <input
              class="form-check-input"
              type="radio"
              name="gender"
              id="gender1"
              value="Male"
              required
            />
            <label class="form-check-label" for="gender1"> Male </label>
          </div>
          <div class="form-check col-md-3">
            <input
              class="form-check-input"
              type="radio"
              name="gender"
              id="gender2"
              value="Female"
              required
            />
            <label class="form-check-label" for="gender2"> Female </label>
          </div>
          <div class="form-check disabled">
            <input
              class="form-check-input"
              type="radio"
              name="gender"
              id="gender3"
              value="Other"
              required
            />
            <label class="form-check-label" for="gender3"> Other </label>
          </div>
        </div>
      </fieldset>

      <div class="col-md-6">
        <label for="dob" class="form-label">D.O.B</label>
        <input type="date" class="form-control" name="dob" id="dob" required />
      </div>

      <div class="col-md-6">
        <label for="profile" class="form-label">Profile Picture</label>
        <input type="file" class="form-control" name="profile" id="profile" />
      </div>

      <div class="col-md-12">
        <div class="col-form-label pt-0 d-block">Courses</div>
        <div class="d-flex gap-1">
          <input
            name="courses"
            class="form-check-input"
            type="checkbox"
            id="cs"
            value="Computer Science"
          />
          <label class="form-check-label" for="cs">Computer Science</label>
        </div>
        <div class="d-flex gap-1">
          <input
            name="courses"
            class="form-check-input"
            type="checkbox"
            id="med"
            value="Medical"
          />
          <label class="form-check-label" for="med">Medical</label>
        </div>
        <div class="d-flex gap-1">
          <input
            name="courses"
            class="form-check-input"
            type="checkbox"
            id="com"
            value="Commerce"
          />
          <label class="form-check-label" for="com">Commerce</label>
        </div>
        <div class="d-flex gap-1">
          <input
            name="courses"
            class="form-check-input"
            type="checkbox"
            id="engr"
            value="Engineering"
          />
          <label class="form-check-label" for="engr">Engineering</label>
        </div>
      </div>

      <div class="col-md-6">
        <label for="country" class="form-label">Country</label>
        <select name="country" id="country" class="form-select">
          <option selected>Choose...</option>
          <option>...</option>
        </select>
      </div>
      <div id="city-col" class="col-md-4 d-none" aria-hidden="true">
        <label for="city" class="form-label">City</label>
        <select name="city" id="city" class="form-select" disabled>
          <option disabled selected value="">Choose...</option>
        </select>
      </div>
      <div class="col-12">
        <button type="submit" class="btn btn-primary">Sign in</button>
      </div>
    </form>
    <!-- TABLE  -->
    <div id="form-heading" class="d-none mt-5 mb-3 w-50">
      <h2 class="fw-bolder display-5">Form Data</h2>
    </div>
    <table class="d-none table mt-2 w-50 ">
      <thead>
        <tr>
          <th scope="col">No.</th>
          <th scope="col">First Name</th>
          <th scope="col">Last Name</th>
          <th scope="col">Email</th>
          <th scope="col">Gender</th>
          <th scope="col">DOB</th>
          <th scope="col">Course</th>
          <th scope="col">Country</th>
          <th scope="col">City</th>
        </tr>
      </thead>
      <tbody id="table-data"></tbody>
    </table>

    <!-- Countries / Cities  -->
    <script>
      (function () {
        const data = {
          Pakistan: ["Karachi", "Lahore", "Islamabad", "Peshawar"],
          "United States": ["New York", "Los Angeles", "Chicago", "Houston"],
          India: ["Mumbai", "Delhi", "Bengaluru", "Chennai"],
          Canada: ["Toronto", "Vancouver", "Montreal", "Calgary"],
          "United Kingdom": ["London", "Manchester", "Birmingham"],
          Australia: ["Sydney", "Melbourne", "Brisbane"],
        };

        const countrySelect = document.getElementById("country");
        const citySelect = document.getElementById("city");
        const cityCol = document.getElementById("city-col");

        function setCityPlaceholder() {
          citySelect.innerHTML = "";
          const opt = document.createElement("option");
          opt.disabled = true;
          opt.selected = true;
          opt.value = "";
          opt.textContent = "Choose...";
          citySelect.appendChild(opt);
        }

        function populateCountries() {
          const first = countrySelect.querySelector("option");
          countrySelect.innerHTML = "";
          const placeholder = document.createElement("option");
          placeholder.value = "";
          placeholder.selected = true;
          placeholder.textContent = "Choose...";
          countrySelect.appendChild(placeholder);

          Object.keys(data).forEach((country) => {
            const opt = document.createElement("option");
            opt.value = country;
            opt.textContent = country;
            countrySelect.appendChild(opt);
          });
        }

        // Show/hide city column
        function showCity(show) {
          if (show) {
            cityCol.classList.remove("d-none");
            cityCol.setAttribute("aria-hidden", "false");
            citySelect.disabled = false;
          } else {
            cityCol.classList.add("d-none");
            cityCol.setAttribute("aria-hidden", "true");
            citySelect.disabled = true;
          }
        }

        // When country changes, populate cities
        countrySelect.addEventListener("change", function () {
          const country = this.value;
          if (!country) {
            setCityPlaceholder();
            showCity(false);
            return;
          }

          const cities = data[country] || [];
          setCityPlaceholder();

          cities.forEach((city) => {
            const opt = document.createElement("option");
            opt.value = city;
            opt.textContent = city;
            citySelect.appendChild(opt);
          });

          showCity(true);
        });

        populateCountries();
        setCityPlaceholder();
        showCity(false);
      })();

      // Form submit
      document
        .querySelector("form")
        .addEventListener("submit", function (event) {
          event.preventDefault(); 
          const formData = new FormData(event.target);

          const formObject = {};
          formData.forEach((value, key) => {
            if (key === "courses") {
              if (!formObject[key]) formObject[key] = [];

              formObject[key].push(value);
            } else {
              formObject[key] = value;
            }
          });

          renderTable(formObject);
          document.getElementById("form-heading").scrollIntoView({
            behavior: "smooth",
          });
        });

      const renderTable = (data) => {
        const table = document.querySelector("table");
        const formHeading = document.getElementById("form-heading");

        table.classList.remove("d-none");
        formHeading.classList.remove("d-none");
        const tableBody = document.getElementById("table-data");
        // tableBody.innerHTML = "";

        let index = tableBody.rows.length;
        const row = document.createElement("tr");
        console.log("data:", data);
        row.innerHTML = `
            <th scope="row">${index + 1}</th>
            <td>${data.firstName}</td>
            <td>${data.lastName}</td>
            <td>${data.email}</td>
            <td>${data.gender}</td>
            <td>${data.dob}</td>
            <td>${
              Array.isArray(data.courses)
                ? data.courses.join(", ")
                : data.courses
            }</td>
            <td>${data.country}</td>
            <td>${data.city}</td>
            `;
        tableBody.appendChild(row);
        index += 1;
      };
    </script>
  </body>
</html>
